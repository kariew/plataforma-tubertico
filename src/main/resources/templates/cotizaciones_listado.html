<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('Listado de Cotizaciones | Tubertico')"></head>
<body>
<!-- Header -->
<th:block th:replace="fragments/header :: header"></th:block>

<section class="container py-5">
  <h1 class="fw-bold mb-4">Listado de Cotizaciones</h1>

  <table class="table table-striped">
    <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Cliente</th>
      <th>Naviera</th>
      <th>Fecha</th>
      <th>Detalle</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="cot : ${cotizaciones}">
      <td th:text="${cot.id}">1</td>
      <td th:text="${cot.usuario.nombre}">Juan Pérez</td>
      <td th:text="${cot.naviera}">Maersk</td>
      <td th:text="${#dates.format(cot.fechaCreacion, 'dd/MM/yyyy HH:mm')}">06/08/2025 20:00</td>
      <td>
        <button class="btn btn-sm btn-outline-primary"
                type="button"
                data-bs-toggle="collapse"
                th:attr="data-bs-target='#detalle__${cot.id}'"
                aria-expanded="false"
                th:attr="aria-controls='detalle__${cot.id}'">
          Ver
        </button>
        <div class="collapse mt-2" th:id="'detalle__' + ${cot.id}">
          <table class="table table-sm">
            <thead>
            <tr>
              <th>Presentación</th>
              <th>Unidades</th>
              <th>Peso (kg)</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item : ${cot.items}">
              <td th:text="${item.presentacion.tipo}">Caja 35 lb</td>
              <td th:text="${item.unidades}">10</td>
              <td th:text="${item.pesoEstimado}">15.88</td>
            </tr>
            </tbody>
          </table>
        </div>
      </td>
    </tr>
    </tbody>
  </table>

  <div th:if="${#lists.isEmpty(cotizaciones)}">
    <p class="text-muted">No hay cotizaciones registradas.</p>
  </div>

  <div class="mt-4">
    <a href="/formulario" class="btn btn-primary">Nueva Cotización</a>
  </div>
</section>

<!-- Footer -->
<div th:replace="fragments/footer :: footer"></div>

<!-- Bootstrap JS (si no lo incluyes en el fragmento footer) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
